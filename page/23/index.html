<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/23/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/23/"/>





  <title>Hexo</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-9-13-heap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-9-13-heap/" itemprop="url">编程珠玑-堆</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##编程珠玑-堆</p>
<p>###定义<br>最小堆：<br>父节点小于其孩子节点</p>
<p>最大堆：<br>父节点大于其孩子节点</p>
<p>###优先级队列</p>
<p>插入操作：插入到堆。实现：插入到第一个空叶子，向上爬直到停止。</p>
<p>输出操作：输出队列中最小或最大的数。实现：输出根节点，最后一个叶子节点替换根节点，然后向下走直到停止。</p>
<p>###堆排序<br>首先建堆，然后不断输出最值并调整堆，如上优先队列的输出操作所示。<br>###应用</p>
<p>构建哈夫曼码</p>
<p>计算大型浮点数集合的和</p>
<p>在存有10亿个数的文件里找出最小100万个数(建立100万个数的最大堆，100万个数小于根数据，如果100亿数据集合里的数据小于根数据，则插入最大堆，最后得到小于根数据的最小100万个数)</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-8-23-gc/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-8-23-gc/" itemprop="url">GC垃圾回收</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="垃圾回收"><a href="#垃圾回收" class="headerlink" title="垃圾回收"></a>垃圾回收</h2><h5 id="哪些垃圾可以回收"><a href="#哪些垃圾可以回收" class="headerlink" title="哪些垃圾可以回收"></a>哪些垃圾可以回收</h5><h4 id="引用计数"><a href="#引用计数" class="headerlink" title="引用计数"></a>引用计数</h4><p>循环引用的垃圾无法回收。</p>
<h4 id="根搜索算法（可达性分析）"><a href="#根搜索算法（可达性分析）" class="headerlink" title="根搜索算法（可达性分析）"></a>根搜索算法（可达性分析）</h4><p>GC roots可以是虚拟机栈、方法区中静态属性引用的对象、方法区常量引用的对象、native方法引用的对象，已启动且未停止的 Java 线程</p>
<ol>
<li>Java 方法栈桢中的局部变量；</li>
<li>已加载类的静态变量；</li>
<li>JNI handles；</li>
<li>已启动且未停止的 Java 线程。</li>
</ol>
<h5 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h5><p>在多线程环境下，其他线程可能会更新已经访问过的对象中的引用，从而造成误报（将引用设置为 null）或者漏报（将引用设置为未被访问过的对象）</p>
<h5 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h5><p><strong>Stop-the-world 以及安全点</strong></p>
<p>停止其他非垃圾回收线程的工作，直到完成垃圾回收。这也就造成了垃圾回收所谓的暂停时间（GC pause）</p>
<p>Java 虚拟机中的 Stop-the-world 是通过安全点（safepoint）机制来实现的。当 Java 虚拟机收到 Stop-the-world 请求，它便会等待所有的线程都到达安全点，才允许请求 Stop-the-world 的线程进行独占的工作。</p>
<ol>
<li>对于解释执行来说，字节码与字节码之间皆可作为安全点。Java 虚拟机采取的做法是，当有安全点请求时，执行一条字节码便进行一次安全点检测。</li>
<li>即时编译器需要插入安全点检测，以避免机器码长时间没有安全点检测的情况。HotSpot 虚拟机的做法便是在生成代码的方法出口以及非计数循环的循环回边（back-edge）处插入安全点检测</li>
</ol>
<h5 id="安全点检测"><a href="#安全点检测" class="headerlink" title="安全点检测"></a>安全点检测</h5><ol>
<li>HotSpot 虚拟机已经将机器码中安全点检测简化为一个内存访问操作，在有安全点请求的情况下，Java 虚拟机会将安全点检测访问的内存所在的页设置为不可读，并且定义一个 segfault 处理器，来截获因访问该不可读内存而触发 segfault 的线程，并将它们挂起</li>
<li>即时编译器生成的机器码打乱了原本栈桢上的对象分布状况。在进入安全点时，机器码还需提供一些额外的信息，来表明哪些寄存器，或者当前栈帧上的哪些内存空间存放着指向对象的引用，以便垃圾回收器能够枚举 GC Roots</li>
</ol>
<h3 id="垃圾收集"><a href="#垃圾收集" class="headerlink" title="垃圾收集"></a>垃圾收集</h3><p>基于根搜索算法，</p>
<ol>
<li>标记-删除(造成内存碎片)</li>
<li>复制(堆使用效率较低)</li>
</ol>
<p><img src="/Users/daitechang/Documents/garydai.github.com/_posts/pic/image-20191102102702213.png" alt="image-20191102102702213"></p>
<ol start="2">
<li><p>标记-整理(性能开销较大)</p>
</li>
<li><p>分代收集算法来回收垃圾。</p>
</li>
</ol>
<p><strong>实验表明大部分的 Java 对象只存活一小段时间，而存活下来的小部分 Java 对象则会存活很长一段时间，所以引入分代回收垃圾思想</strong></p>
<p>新生代用来存储新建的对象。当对象存活时间够长时，则将其移动到老年代，给不同代使用不同的回收算法</p>
<p>其中分代搜集算法利用前三种算法收集不同类型的垃圾。</p>
<p>分代收集：对于新生代采用复制算法，对于老年代采用标记-整理或标记-清除</p>
<p>python:采用引用计数和分代搜集算法</p>
<h3 id="java分代收集"><a href="#java分代收集" class="headerlink" title="java分代收集"></a>java分代收集</h3><p>主要是CMS收集器（concurrent mark sweep）</p>
<p>G1收集器（整体是标记整理，局部是复制）</p>
<p>java server模式下，默认使用Parallel Scavenge + Serial Old收集器组合进行回收</p>
<h3 id="java内存分配"><a href="#java内存分配" class="headerlink" title="java内存分配"></a>java内存分配</h3><p>多线程同时申请内存存在并发问题，解决方案是每个线程可以向 Java 虚拟机申请一段连续的内存，比如 2048 字节，作为线程私有的 TLAB（Thread Local Allocation Buffer）。</p>
<p>对象优先在Eden和一个survivor0分配；</p>
<ol>
<li>再次分配时，如果内存不够，则垃圾收集，把eden和suvivor0存活的对象放到另一个survivor1，同时对象年纪+1；如果survivor1内存不够，且老年代内存足够，则放到老年代，如果对象年纪到达老年代也直接放到老年代；如果老年代内存也不够，则需要进行老年代内存回收即full gc</li>
<li>然后清除eden和survivor0；</li>
<li>survivor0和survivor1互换，原survivor1区成为下次的survivor0区</li>
</ol>
<p>针对新生代的垃圾回收器共有三个：Serial，Parallel Scavenge 和 Parallel New。这三个采用的都是标记 - 复制算法。其中，Serial 是一个单线程的，Parallel New 可以看成 Serial 的多线程版本。Parallel Scavenge 和 Parallel New 类似，但更加注重吞吐率。此外，Parallel Scavenge 不能与 CMS 一起使用</p>
<p>针对老年代的垃圾回收器也有三个：刚刚提到的 Serial Old 和 Parallel Old，以及 CMS。Serial Old 和 Parallel Old 都是标记 - 压缩算法。同样，前者是单线程的，而后者可以看成前者的多线程版本</p>
<h3 id="减少minor-gc时间"><a href="#减少minor-gc时间" class="headerlink" title="减少minor gc时间"></a>减少minor gc时间</h3><p>复制对象的成本要远高于扫描成本，所以，单次<strong>Minor GC时间更多取决于GC后存活对象的数量，而非Eden区的大小</strong>。因此如果堆中短期对象很多，那么扩容新生代，单次Minor GC时间不会显著增加</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-7-8-probility_problem/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-7-8-probility_problem/" itemprop="url">概率题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##概率题<br>###题目<br>已知随机函数old_rand(),以p的概率产生0，以1-p的概率产生1，要求设计一个新的随机函数newRand(),使其以等概率生成1和0。</p>
<p>###解答</p>
<pre><code>def new_rand():

    first = old_rand()
    second = old_rand()
    if first == 0 and second == 1
        return 0
    if first == 1 and second == 0
        return 1
    else return new_rand()</code></pre><p>###分析<br>返回0的概率不是简单的从第一个if中得出p(1-p)，第三步也会有概率返回0</p>
<p>设t = p(1-p)</p>
<p>返回0的概率： t + (1-2t)*t + (1-2t)^2 *t + (1-2t)^3 *t + … + (1-2t)^n *t + … <del>~</del> t/(1-1+2t) = 1/2</p>
<p>同理得出返回1的概率：1/2</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-7-7-probility-code/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-7-7-probility-code/" itemprop="url">编程实现k/n的概率</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="编程实现k-n的概率"><a href="#编程实现k-n的概率" class="headerlink" title="编程实现k/n的概率"></a>编程实现k/n的概率</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><pre><code>m = random(1, n);   
if(m &lt; k)
    return m;
else -1;</code></pre><p>k/n的概率返回k内的数字，k内的数字m被选中的概率是多少?</p>
<p>是k/n呢还是k/n * 1/k？</p>
<pre><code>count = 0
count2 = 0
summ = 10000000
for i in range(summ):
    k = 6
    m = random.choice(range(10))
    if(m &lt; k):
        count = count + 1
        if m == 1:
            count2 = count2 + 1

print count * 1.0 / summ 0.5998247 ~~ 6/10
print count2 * 1.0 / count 0.166646688608 ~~ 1/6</code></pre><p>###结论<br>k内的数字m被选中的概率是k/n * 1/k    = 1/n</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-7-7-match_choose/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-7-7-match_choose/" itemprop="url">多队伍比赛的对手抽签算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##多队伍比赛的对手抽签算法</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-7-7-joseph/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-7-7-joseph/" itemprop="url">约瑟夫环问题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##约瑟夫环问题<br>###问题<br>有编号从1到N的N个人坐成一圈报数，报到M的人出局，下一位再从1开始, 如此持续，直止剩下一位为止，报告此人的编号X。输入N,M，求出X。</p>
<p>###分析<br>N=8 M=3</p>
<pre><code>        0 1 2 3 4 5 6 7
第1次    5 6 X 0 1 2 3 4
第2次    2 3   4 5 X 0 1
 3      X 0   1 2   3 4      
 4        2   3 X   0 1 
 5        X   0     1 2
 6            0     1 X  
 7            X     1
 8                  0</code></pre><p>每一次去掉退出的人后，重新排编号</p>
<p>第8次剩下0，对应初始编号6</p>
<p>###代码</p>
<pre><code>递归
def recursion(n, m):
    if(n == 1):
        return 0
    return (recursion(n - 1, m) + m)%n

循环
def loop(n, m):
    a = 0
    for i in range(2, n + 1):
        a = (a + m) % i

    return a


print recursion(10, 11), loop(10, 11)</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-7-22-virtual_memory/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-7-22-virtual_memory/" itemprop="url">虚拟内存</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##虚拟存储器</p>
<p>虚拟存储器是对主存的一个抽象。没理解这句话就是没理解虚拟存储器。</p>
<p>虚拟存储器表示程序中使用的地址空间，实际数据分配在硬盘，缓存在内存。</p>
<p>每个进程都有一个独立的页表，把虚拟存储器地址空间映射到内存地址空间。</p>
<p>###地址翻译<br>MMU通过存放在内存或者高速缓存的页表，把CPU传进来的虚拟地址转化成物理地址，然后访问内存得到数据。</p>
<p>如果页表条目表示虚拟地址请求的页面不在内存，则会进入缺页处理程序，把所需的页面载入到内存，然后再次进行地址翻译。</p>
<p>高速缓存是内存的缓存</p>
<p>TLB是页表条目的缓存</p>
<p>i7地址翻译图</p>
<p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/address_translate.PNG" alt="">  </p>
<p>###虚拟存储器的作用<br>1.在主存中自动缓存最近使用的存放磁盘上的虚拟地址空间的内容。</p>
<p>2.简化存储器管理、链接、加载。</p>
<p>3.简化存储器保护。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-7-5-pool_probilitymd/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-7-5-pool_probilitymd/" itemprop="url">随机抽样与洗牌算法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##随机抽样与洗牌算法<br>###问题-选择抽样<br>给出一个数据流，这个数据流的长度很大或者未知。并且对该数据流中数据只能访问一次。请写出一个随机选择算法，使得数据流中所有数据被选中的概率相等。<br>###解答<br>数据流一个接着一个的过来，根据一定的概率选择取或不取</p>
<p>数据流里只有一个数据，那么直接取该数据，概率为1</p>
<p>数据流里有两个数据，当第一个数据到达，取该数据，第二个数据达到，以1/2的概率取该数据，或者以1/2的概率取上一次取的数据。则数据流中数据被选中概率为1/2</p>
<p>数据流里有三个数据，当第一个、第二个数据到达，同上分析，当第三个数据到达，以1/3的概率取该数据，以2/3的数据取上一次的数据。则取到上一次数据的概率为2/3*1/2 = 1/3。</p>
<p>数据1被选中的概率1/2 * 2/3 = 1/3<br>数据2被选中的概率1/2 * 2/3 = 1/3<br>数据3被选中的概率1/3</p>
<p>所以假设选择算法为：当第n个数据到来时，以1/n的概率选择该数据，否则选中上一个数据。</p>
<p>推导：假设当有n-1个数据，假设成立，则选择其中一个数据的概率为1/(n-1)，当第n个数据到来，以1/n的概率选择该数据，否则以(n-1)/n选择上一个数据。则上一个数据被选择的概率为1/(n-1)*(n-1)/n=1/n，则每个数据选择的概率都为1/n。</p>
<p>###问题2-水库抽样<br>如果从数据流里以相同概率选中k个数据。</p>
<p>假设选择两个数据。</p>
<p>两个数据选两个，第一个数据到来，以概率1选中，第二个到来也以概率1选中。</p>
<p>三个数据，所求概率为2/3。第三个数据到来，以2/3的概率选中该数据，前两个数据被留下的概率为2/3*1/2=1/3。当1/3的概率没选中第三个数据，则前两个数据被留下的概率为1/3，综合两种情形，前两个数据被留下的概率为1/3+1/3 = 2/3。则每个数据被留下的概率都为2/3</p>
<p>###问题3-洗牌</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-7-18-probility_check/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-7-18-probility_check/" itemprop="url">随机数据的一般检验方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##随机数据的一般检验方法</p>
<p>###X2检验<br>###KS检验</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-3-memory/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-3-memory/" itemprop="url">windows内存模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="windows内存模型"><a href="#windows内存模型" class="headerlink" title="windows内存模型"></a>windows内存模型</h2><p>系统调拨物理存储器(磁盘中的页交换文件和文件映像)给进程的数据与程序，把地址映射到进程地址空间。<br>一开始进程所有页面都在磁盘上，内存中没有数据与程序，所以要先从它们的物理存储器中调入内存。<br><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/read_memory.PNG" alt="">    </p>
<h3 id="进程虚拟地址空间"><a href="#进程虚拟地址空间" class="headerlink" title="进程虚拟地址空间"></a>进程虚拟地址空间</h3><p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/virtual_memory.PNG" alt="">        </p>
<h3 id="虚拟内存"><a href="#虚拟内存" class="headerlink" title="虚拟内存"></a>虚拟内存</h3><p>让磁盘空间看起来像内存一样，这部分磁盘空间称为页交换文件。<br>页交换文件在硬盘上，一种内存的后备存储器。把页交换文件映射到进程地址空间。      </p>
<h4 id="使用虚拟内存"><a href="#使用虚拟内存" class="headerlink" title="使用虚拟内存"></a>使用虚拟内存</h4><p>1.预定地址空间区域   </p>
<pre><code>PVOID VirtualAlloc(
    PVOID pvAddress,
    SIZE_T dwSize,
    DWORD fdwAllocationType,
    DWORD fdwProtect);</code></pre><p>fdwAllocationType设置为MEM_RESERVE    </p>
<p>2.调拨物理存储器(页交换文件)<br>fdwAllocationType设置为MEM_COMMIT<br>3.撤销调拨物理存储器及释放区域   </p>
<pre><code>BOOL VirtualFree(
    LPVOID pvAddress,
    SIZE_T dwSize,
    DWORD fdwFreeType);</code></pre><h4 id="线程栈"><a href="#线程栈" class="headerlink" title="线程栈"></a>线程栈</h4><p>系统创建线程时，会给线程栈预订一块地址空间区域，并调拨页交换文件(大小由.exe的PE文件头中变量指定)。</p>
<h3 id="内存映射文件"><a href="#内存映射文件" class="headerlink" title="内存映射文件"></a>内存映射文件</h3><p>文件映像(.exe文件或DLL)，另一种后备存储器，称之为内存映射文件，映射到进程地址空间。<br>硬盘上的文件映射在进程的地址空间中。<br>1.创建或打开文件，创建文件内核对象    </p>
<pre><code>HANDLE CreateFile(
    PCSTR pszFileName,
    DWORD dwDesiredAccess,
    DWORD dwShareMode,
    PSECURITY_ATTRIBUTES psa,
    DWORD dwCreationDisposition,
    DWORD dwFlagsAndAttributes,
    HANDLE hTemplateFile);</code></pre><p>2.创建内存映射文件内核对象   </p>
<pre><code>HANDLE CreateFileMapping(
    HANDLE hFile,
    PSECURITY_ATTRIBUTES psa,
    DWORD fdwProtect,
    DWORD dwMaximumSizeHigh,
    DWORD dwMaximumSizeLow,
    PCTSTR pszName);</code></pre><p>3.映射到进程地址空间，在地址空间中预订区域并调拨物理存储器  </p>
<pre><code>PVOID MapViewOfFile(
    HANDLE hFileMappingObject,
    DWORD dwDesiredAccess,
    DWORD dwFileOffSetHigh,
    DWORD dwFileOffSetLow,
    SIZE_T dwNumberOfBytesToMap);</code></pre><h4 id="用应用程序的共享段实现多个实例间的共享静态数据"><a href="#用应用程序的共享段实现多个实例间的共享静态数据" class="headerlink" title="用应用程序的共享段实现多个实例间的共享静态数据"></a>用应用程序的共享段实现多个实例间的共享静态数据</h4><p>告诉编译器把变量放入单独的段中    </p>
<pre><code>#pragma data_seg(&quot;shared&quot;)
#pragma data_set()
#pragma comment(linker, &quot;/SECTION:Shared,RWS&quot;)</code></pre><p>####用内存映射文件在进程间共享数据<br>当启动一个应用程序，系统会先调用CreateFile打开.exe文件，接着调用CreateFileMapping创建文件映射对象，最后调用MapViewOfFileEx映射到进程的固定地址空间(有.exe的PE文件指定基地址)。打开同一个应用程序，系统发现已经存在文件映射对象，就调用MapViewOfFileEx映射.exe文件到对应进程的地址空间。所以系统把相同文件映射到不同进程中，令进程共享程序的代码与数据。<br>####以页交换文件为后备存储器的内存映射文件<br>不再以磁盘文件作为后备存储器，则不需要打开文件创建文件内核对象，直接创建内存映射文件对象，把页交换文件映射到内存。<br>多进程可以利用页交换文件的内存映射文件来共享数据。利用对映射文件对象取别名来标记对象。<br>###堆<br>进程创建的时候，系统会分配一个默认堆。<br>调拨的物理存储器来自页交换文件。<br>####创建额外堆<br>    HeapCreate(<br>        DWORD fdwOptions,<br>        SIZE_T dwInitialSize,<br>        SIZE_T dwMaximumSize);<br>不能保证线程独占堆则不能设置fdwOptions为HEAP_NO_SERIALIZE，保证多线程对同一个堆的访问时依次进行。<br>####从堆中分配内存<br>    PVOID HeapAlloc(<br>        HANDLE hHeap,<br>        DWORD fdwFlags,<br>        SIZE_T dwBytes);</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/22/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/22/">22</a><span class="page-number current">23</span><a class="page-number" href="/page/24/">24</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" href="/page/24/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">273</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
