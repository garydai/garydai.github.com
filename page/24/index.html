<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/24/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/24/"/>





  <title>Hexo</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-7-ucc_compiler_code_review/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-7-ucc_compiler_code_review/" itemprop="url">一款开源C语言编译器源码解析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##一款开源C语言编译器源码解析<br>###预编译</p>
<p>###词法分析 lex.c<br>token表     </p>
<pre><code>//keywords
TOKEN(TK_AUTO,      &quot;auto&quot;)
TOKEN(TK_EXTERN,    &quot;extern&quot;)
TOKEN(TK_REGISTER,  &quot;register&quot;)
TOKEN(TK_STATIC,    &quot;static&quot;)
TOKEN(TK_TYPEDEF,   &quot;typedef&quot;)
TOKEN(TK_CONST,     &quot;const&quot;)
TOKEN(TK_VOLATILE,  &quot;volatile&quot;)
TOKEN(TK_SIGNED,    &quot;signed&quot;)
TOKEN(TK_UNSIGNED,  &quot;unsigned&quot;)
TOKEN(TK_SHORT,     &quot;short&quot;)
TOKEN(TK_LONG,      &quot;long&quot;)
TOKEN(TK_CHAR,      &quot;char&quot;)
TOKEN(TK_INT,       &quot;int&quot;)
TOKEN(TK_INT64,     &quot;__int64&quot;)
TOKEN(TK_FLOAT,     &quot;float&quot;)
TOKEN(TK_DOUBLE,    &quot;double&quot;)
TOKEN(TK_ENUM,      &quot;enum&quot;)
TOKEN(TK_STRUCT,    &quot;struct&quot;)
TOKEN(TK_UNION,     &quot;union&quot;)
TOKEN(TK_VOID,      &quot;void&quot;)
TOKEN(TK_BREAK,     &quot;break&quot;)
TOKEN(TK_CASE,      &quot;case&quot;)
TOKEN(TK_CONTINUE,  &quot;continue&quot;)
TOKEN(TK_DEFAULT,   &quot;default&quot;)
TOKEN(TK_DO,        &quot;do&quot;)
TOKEN(TK_ELSE,      &quot;else&quot;)
TOKEN(TK_FOR,       &quot;for&quot;)
TOKEN(TK_GOTO,      &quot;goto&quot;)
TOKEN(TK_IF,        &quot;if&quot;)
TOKEN(TK_RETURN,    &quot;return&quot;)
TOKEN(TK_SWITCH,    &quot;switch&quot;)
TOKEN(TK_WHILE,     &quot;while&quot;)
TOKEN(TK_SIZEOF,    &quot;sizeof&quot;)

//identifier
TOKEN(TK_ID,        &quot;ID&quot;)

//constant
TOKEN(TK_INTCONST,     &quot;int&quot;)
TOKEN(TK_UINTCONST,    &quot;unsigned int&quot;)
TOKEN(TK_LONGCONST,    &quot;long&quot;)
TOKEN(TK_ULONGCONST,   &quot;unsigned long&quot;)
TOKEN(TK_LLONGCONST,   &quot;long long&quot;)
TOKEN(TK_ULLONGCONST,  &quot;unsigned long long&quot;)
TOKEN(TK_FLOATCONST,   &quot;float&quot;)
TOKEN(TK_DOUBLECONST,  &quot;double&quot;)
TOKEN(TK_LDOUBLECONST, &quot;long double&quot;)
TOKEN(TK_STRING,       &quot;STR&quot;)
TOKEN(TK_WIDESTRING,   &quot;WSTR&quot;)

//operators
TOKEN(TK_COMMA,         &quot;,&quot;)
TOKEN(TK_QUESTION,      &quot;?&quot;)
TOKEN(TK_COLON,         &quot;:&quot;)
TOKEN(TK_ASSIGN,        &quot;=&quot;)
TOKEN(TK_BITOR_ASSIGN,  &quot;|=&quot;)
TOKEN(TK_BITXOR_ASSIGN, &quot;^=&quot;)
TOKEN(TK_BITAND_ASSIGN, &quot;&amp;=&quot;)
TOKEN(TK_LSHIFT_ASSIGN, &quot;&lt;&lt;=&quot;)
TOKEN(TK_RSHIFT_ASSIGN, &quot;&gt;&gt;=&quot;)
TOKEN(TK_ADD_ASSIGN,    &quot;+=&quot;)
TOKEN(TK_SUB_ASSIGN,    &quot;-=&quot;)
TOKEN(TK_MUL_ASSIGN,    &quot;*=&quot;)
TOKEN(TK_DIV_ASSIGN,    &quot;/=&quot;)
TOKEN(TK_MOD_ASSIGN,    &quot;%=&quot;)
TOKEN(TK_OR,            &quot;||&quot;)
TOKEN(TK_AND,           &quot;&amp;&amp;&quot;)
TOKEN(TK_BITOR,         &quot;|&quot;)
TOKEN(TK_BITXOR,        &quot;^&quot;)
TOKEN(TK_BITAND,        &quot;&amp;&quot;)
TOKEN(TK_EQUAL,         &quot;==&quot;)
TOKEN(TK_UNEQUAL,       &quot;!=&quot;)
TOKEN(TK_GREAT,         &quot;&gt;&quot;)
TOKEN(TK_LESS,          &quot;&lt;&quot;)
TOKEN(TK_GREAT_EQ,      &quot;&gt;=&quot;)
TOKEN(TK_LESS_EQ,       &quot;&lt;=&quot;)
TOKEN(TK_LSHIFT,        &quot;&lt;&lt;&quot;)
TOKEN(TK_RSHIFT,        &quot;&gt;&gt;&quot;)
TOKEN(TK_ADD,           &quot;+&quot;)
TOKEN(TK_SUB,           &quot;-&quot;)
TOKEN(TK_MUL,           &quot;*&quot;)
TOKEN(TK_DIV,           &quot;/&quot;)
TOKEN(TK_MOD,           &quot;%&quot;)
TOKEN(TK_INC,           &quot;++&quot;)
TOKEN(TK_DEC,           &quot;--&quot;)
TOKEN(TK_NOT,           &quot;!&quot;)
TOKEN(TK_COMP,          &quot;~&quot;)
TOKEN(TK_DOT,           &quot;.&quot;)
TOKEN(TK_POINTER,       &quot;-&gt;&quot;)
TOKEN(TK_LPAREN,        &quot;(&quot;)
TOKEN(TK_RPAREN,        &quot;)&quot;)
TOKEN(TK_LBRACKET,      &quot;[&quot;)
TOKEN(TK_RBRACKET,      &quot;]&quot;)

//punctuators
TOKEN(TK_LBRACE,        &quot;{&quot;)
TOKEN(TK_RBRACE,        &quot;}&quot;)
TOKEN(TK_SEMICOLON,     &quot;;&quot;)
TOKEN(TK_ELLIPSE,       &quot;...&quot;)
TOKEN(TK_POUND,         &quot;#&quot;)
TOKEN(TK_NEWLINE,       &quot;\n&quot;)

TOKEN(TK_END,           &quot;EOF&quot;)</code></pre><p>各种处理字符的函数scanxxx，组成函数指针数组。 </p>
<pre><code>static Scanner        Scanners[256]; </code></pre><p>得到每个token    </p>
<pre><code>#define NEXT_TOKEN  CurrentToken = GetNextToken();</code></pre><p>###语法解析<br>语法解析与词法分析一起执行，取一个token然后解析。 </p>
<p>将整个cpp，解析成一个语法树。 </p>
<pre><code>Decl.c
transUnit = ParseTranslationUnit(file);</code></pre><p>####语法解析程序结构</p>
<pre><code>ParseTranslationUnit

    ParseExternalDeclaration//解析外部声明

        ParseCommonHeader//各种声明的共同部分

            ParseDeclarationSpecifiers//处理类型限定符(const)、说明符(int)、存储地说明符(auto)

            ParseInitDeclarator

                ParseDeclarator

                ParsePostfixDeclarator

                    ParseDirectDeclarator

        GetFunctionDeclarator

        ParseCompoundStatement//如果是函数定义，解析函数的实现、

            ParseDeclaration

            ParseStatement

                ParseLabelStatement

                ParseCaseStatement

                ParseDefaultStatement

                ParseIfStatement

                ParseSwitchStatement

                ParseWhileStatement

                ParseDoStatement

                ParseForStatement

                ParseGotoStatement

                ParseContinueStatement

                ParseBreakStatement

                ParseReturnStatement

                ParseCompoundStatement

                ParseExpressionStatement                                        </code></pre><p>####解析表达式</p>
<pre><code>ParseExpression

/**
 *  assignment-expression:
 *      conditional-expression

 *      unary-expression assignment-operator assignment-expression
 *  assignment-operator:
 *      = *= /= %= += -= &lt;&lt;= &gt;&gt;= &amp;= ^= |=
 *  There is a little twist here: the parser always treats the first nonterminal
 *  as a conditional expression.
 */    
    ParseAssignmentExpression

        ParseConditionalExpression

        ParseAssignmentExpression</code></pre><p>####语法树<br>    typedef struct astNode<br>    {<br>        AST_NODE_COMMON<br>    } *AstNode;</p>
<pre><code>ast节点结构
#define AST_NODE_COMMON   \
    int kind;             \节点类型
    struct astNode *next; \
    struct coord coord;

节点类型
enum nodeKind 
{ 
    NK_TranslationUnit,     NK_Function,           NK_Declaration,
    NK_TypeName,            NK_Specifiers,         NK_Token,                
    NK_TypedefName,         NK_EnumSpecifier,      NK_Enumerator,            
    NK_StructSpecifier,     NK_UnionSpecifier,     NK_StructDeclaration,    
    NK_StructDeclarator,    NK_PointerDeclarator,  NK_ArrayDeclarator,        
    NK_FunctionDeclarator,  NK_ParameterTypeList,  NK_ParameterDeclaration,
    NK_NameDeclarator,      NK_InitDeclarator,     NK_Initializer,

    NK_Expression,

    NK_ExpressionStatement, NK_LabelStatement,     NK_CaseStatement,        
    NK_DefaultStatement,    NK_IfStatement,        NK_SwitchStatement,        
    NK_WhileStatement,      NK_DoStatement,        NK_ForStatement,        
    NK_GotoStatement,       NK_BreakStatement,     NK_ContinueStatement,        
    NK_ReturnStatement,     NK_CompoundStatement
};

编译单元cpp
struct astTranslationUnit
{
    AST_NODE_COMMON
    AstNode extDecls;
};</code></pre><p>###语义分析    </p>
<pre><code>CheckTranslationUnit(transUnit);</code></pre><p>####语法解析程序结构</p>
<pre><code>CheckFunction

CheckGlobalDeclaration</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-25-CRT/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-25-CRT/" itemprop="url">C运行时库</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="C运行时库"><a href="#C运行时库" class="headerlink" title="C运行时库"></a>C运行时库</h2><h3 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h3><p>1.启动与退出：入口、出口及相关函数</p>
<p>2.c语言标准函数库</p>
<p>3.I/O相关函数</p>
<p>4.堆管理</p>
<p>5.调试功能</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-24-function_stack/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-24-function_stack/" itemprop="url">函数与栈</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##函数与栈<br>###调用函数过程<br>压栈函数参数，压入返回地址(调用函数的下一条指令地址),压入老的栈底，压入调用方的寄存器和临时空间(可选)。<br>###函数返回值<br>1.函数的返回值，通过寄存器eax传递给调用方，函数把返回值赋给eax。返回值大小最多64位，两个寄存器。     </p>
<p>2.若大于64位的返回值(一个结构或类)，首先在栈上分配一块空间，然后把空间地址赋给eax，再把eax寄存器压入栈，相当于传入一个隐藏的函数参数，把返回值复制到eax指向的空间里。所以返回值保存在eax指向的空间里。 </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-23-page_build_fail/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-23-page_build_fail/" itemprop="url">github page build failed</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##github page build failed<br>提交博客到github的时候，收到邮件说page build failed，谷歌了一下，好像是github的jekyll版本更新了，加强了语法规则，所以需要下载jekyll检查下自己博客系统的语法问题。<br>###windows下安装jekyll<br>首先从<a href="http://rubyinstaller.org/downloads/下载以下两个文件进行安装" target="_blank" rel="noopener">http://rubyinstaller.org/downloads/下载以下两个文件进行安装</a><br>rubyinstaller-2.0.0-p0.exe<br>DevKit-mingw64-32-4.7.2-20130224-1151-sfx.exe</p>
<p>老是安装不上，于是看了下别人的github，写markdown: rdiscount到_config.yml就能成功显示页面了。  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-2-puzzle/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-2-puzzle/" itemprop="url">面试题</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##面试题<br>###题目<br>有一个淘宝商户，在某城市有n个仓库，每个仓库的储货量不同，现在要通过货物运输，将每个仓库的储货量变成一致的，n个仓库之间的运输线路围城一个圈，即1-&gt;2-&gt;3-&gt;4-&gt;…-&gt;n-&gt;1-&gt;…，货物只能通过连接的仓库运输，设计最小的运送成本（运货量*路程）达到淘宝商户的要求，并写出代码。<br>###思路<br>###code<br>###类似题目<br>均分纸牌<br>石子合并问题<br>矩阵连乘问题</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-16-static/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-16-static/" itemprop="url">Static变量</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="静态变量"><a href="#静态变量" class="headerlink" title="静态变量"></a>静态变量</h2><h3 id="静态变量-普通变量"><a href="#静态变量-普通变量" class="headerlink" title="静态变量 普通变量"></a>静态变量 普通变量</h3><h3 id="静态函数-普通函数"><a href="#静态函数-普通函数" class="headerlink" title="静态函数 普通函数"></a>静态函数 普通函数</h3><h3 id="类中变量"><a href="#类中变量" class="headerlink" title="类中变量"></a>类中变量</h3><h3 id="类中函数"><a href="#类中函数" class="headerlink" title="类中函数"></a>类中函数</h3><p>notes:<br>全局变量、局部静态变量在目标文件的数据段。  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">c语言</span><br><span class="line"></span><br><span class="line">    int a ;</span><br><span class="line">    main()</span><br><span class="line">    &#123;</span><br><span class="line">             int b ; </span><br><span class="line">             int c* &#x3D; (int *)malloc(sizeof(int));</span><br><span class="line">        &#125;</span><br><span class="line">        a是全局变量，b是栈变量，c是堆变量。</span><br><span class="line">       static对全局变量的修饰，可以认为是限制了只能是本文件引用此变量。有的程序是由好多.c文件构成。彼此可以互相引用变量，但加入static修饰之后，只能被本文件中函数引用此变量。</span><br><span class="line">        static对栈变量的修饰，可以认为栈变量的生命周期延长到程序执行结束时。一般来说，栈变量的生命周期由OS管理，在退栈的过程中，栈变量的生命也就结束了。但加入static修饰之后，变量已经不在存储在栈中，而是和全局变量一起存储。同时，离开定义它的函数后不能使用，但如再次调用定义它的函数时，它又可继续使用， 而且保存了前次被调用后留下的值。</span><br><span class="line">       static对函数的修饰与对全局变量的修饰相似，只能被本文件中的函数调用，而不能被同一程序其它文件中的函数调用。 </span><br><span class="line">      static 声明的变量在C语言中有两方面的特征：</span><br><span class="line">　　1)、变量会被放在程序的全局存储区中，这样可以在下一次调用的时候还可以保持原来的赋值。这一点是它与堆栈变量和堆变量的区别。 </span><br><span class="line">　　2)、变量用static告知编译器，自己仅仅在变量的作用范围内可见。这一点是它与全局变量的区别。</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-14-python_book/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-14-python_book/" itemprop="url">25本免费的Python电子书</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##25本免费的Python电子书<br>1.<a href="http://greenteapress.com/thinkstats/html/index.html" target="_blank" rel="noopener">Think Stats</a><br>2.<a href="http://www.diveintopython.net/toc/index.html" target="_blank" rel="noopener">Dive Into Python</a><br>3.<a href="http://files.swaroopch.com/python/byteofpython_120.pdf" target="_blank" rel="noopener">A Byte Of Python</a><br>4.<a href="http://greenteapress.com/complexity/html/index.html" target="_blank" rel="noopener">Think Complexity</a><br>5.<a href="http://getpython3.com/diveintopython3/whats-new.html" target="_blank" rel="noopener">Dive Into Python 3</a><br>6.<a href="https://docs.djangoproject.com/en/dev/intro/" target="_blank" rel="noopener">DJANGO TUTORIAL</a><br>7.<a href="http://www.itmaybeahack.com/book/oodesign-python-2.1/html/index.html" target="_blank" rel="noopener">Building Skills In OOP</a><br>8.<a href="http://docs.pylonsproject.org/projects/pyramid_tutorials/en/latest/humans/index.html" target="_blank" rel="noopener">Pyramid For Humans</a><br>9.<a href="http://flask.pocoo.org/docs/tutorial/" target="_blank" rel="noopener">Flask Microframework</a><br>10.<a href="http://www.itmaybeahack.com/book/python-2.6/html/index.html" target="_blank" rel="noopener">Building Skills In Python</a><br>11.<a href="http://kivy.org/docs/pdf/Kivy-latest.pdf" target="_blank" rel="noopener">Kivy Programming Guide</a><br>12.<a href="http://www.briggs.net.nz/snake-wrangling-for-kids.html" target="_blank" rel="noopener">Snake Wrangling For Kids</a><br>13.<a href="http://beastie.cs.ua.edu/cs150/book/index.html" target="_blank" rel="noopener">An Introduction To Python</a><br>14.<a href="http://inforef.be/swi/download/apprendre_python.pdf" target="_blank" rel="noopener">Programmez Avec Python 2</a><br>15.<a href="http://inforef.be/swi/download/apprendre_python3_5.pdf" target="_blank" rel="noopener">Programmez Avec Python 3</a><br>16.<a href="http://www.doughellmann.com/PyMOTW/contents.html" target="_blank" rel="noopener">Python Module Of The Week</a><br>17.<a href="http://learnpythonthehardway.org/book/" target="_blank" rel="noopener">Learn Python The Hard Way</a><br>18.<a href="http://effbot.org/zone/librarybook-index.htm" target="_blank" rel="noopener">The Standard Python Library</a><br>19.<a href="http://www.itmaybeahack.com/homepage/books/nonprog/html/index.html" target="_blank" rel="noopener">Building Skills In Programming</a><br>20.<a href="http://scipy-lectures.github.com/" target="_blank" rel="noopener">Python Scientific Lecture Notes</a><br>21.<a href="http://inventwithpython.com/pygame/chapters/" target="_blank" rel="noopener">Making Games With Python &amp; Pygame</a><br>22.<a href="http://cutter.rexx.com/~dkuhlman/python_101/python_101.html" target="_blank" rel="noopener">Python 101 (an introduction to python)</a><br>23.<a href="http://www.greenteapress.com/thinkpython/thinkCSpy/thinkCSpy.pdf" target="_blank" rel="noopener">How To Think Like A Computer Scientist</a><br>24.<a href="https://sites.google.com/site/naturallanguagetoolkit/book" target="_blank" rel="noopener">Natural Language Processing With Python</a><br>25.<a href="http://programmingcomputervision.com/downloads/Draft_20120318.pdf" target="_blank" rel="noopener">Programming Computer Vision With Python</a><br>##Python免费书籍汇总<br><a href="http://pythonbooks.revolunet.com/" target="_blank" rel="noopener">http://pythonbooks.revolunet.com/</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-13-loader_linker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-13-loader_linker/" itemprop="url">链接器和加载器</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>##链接器和加载器   </p>
<p>###链接器<br>链接各个模块至同一个进程空间。</p>
<p>整合各个模块的段,确定段在地址空间的基地址。</p>
<p>根据重定位表，重定位符号。    </p>
<p>主要任务：符号解析、重定位。</p>
<p>####目标文件<br>可重定位目标文件</p>
<p>可执行目标文件</p>
<p>共享目标文件</p>
<p>#####符号表<br>记录目标文件里的符号名和对应符号在目标文件所属段中的地址    </p>
<p>1.定义在本目标文件并能被其他模块引用的全局符号(非静态全局变量、非静态函数)    </p>
<p>2.引用外部目标文件的全局符号</p>
<p>3.定义引用在本目标文件的本地符号(静态函数、静态变量)</p>
<p>4.段名(与链接无关)    </p>
<p>5.静态局部符号(与链接无关)</p>
<p>6.行号信息(与链接无关)    </p>
<p>强符号：函数和初始化的全局变量      </p>
<p>弱符号：未初始化的全局变量 </p>
<p>unix链接器处理多重定义符号的规则：不允许有多个强符号；如果有强符号和弱符号，选择强符号；对于多个弱符号定义，任意选择一个。</p>
<p>强引用：</p>
<p>强符号：</p>
<p>####静态链接<br>把多个目标文件打包成静态库，链接静态库的时候，载入静态库里被引用的目标文件，而不用载入所有目标文件</p>
<p>链接目标文件、重定位符号，生成可执行文件。   </p>
<p>符号重定位在链接时确定。   </p>
<p>#####符号解析<br>对于引用的符号，绑定到唯一的定义。</p>
<p>对于引用了但尚未在本地定义的符号，找到相应的目标文件中该符号的定义。</p>
<p>方法：遍历所有输入目标文件，找到定义符号的目标文件。</p>
<p>#####重定位<br>合并输入模块，并为所有符号分配运行时地址(进程虚拟地址)</p>
<p>1.重定位节和符号定义：合并相同的节，并重定位节地址和已经定义的符号地址。</p>
<p>2.重定位节中的符号引用。该步骤依赖于重定位表。</p>
<p>######重定位表<br>如果一个段中的符号需要重定位，则会有一个相应的重定位段。例如.text段需要重定位，则产生一个.rel.text重定位段。相对应.data有.rel.data重定位段。</p>
<p>记录需要重定位的符号在相应段中的偏移，和重定位类型(PC相对地址、绝对地址等)。</p>
<p>######unix重定位算法<br>遍历所有.rel段中的符号，根据重定位类型，重定位符号地址。</p>
<p>####动态链接<br>链接、重定位过程推迟到运行加载时。较之静态链接，使用共享模块，可以节省内存，易于维护升级程序。            </p>
<p>#####共享模块(dll,so)<br>模块内的符号引用采用相对地址。   </p>
<p>#####地址无关代码<br>代码中引用的符号地址通过查表得到，而不是把符号地址写入代码。</p>
<p>模块间的符号引用,因为外部符号地址在装载时候才能确定，查询全局偏移表(GOT)得到外部符号地址，令指令代码与地址无关。</p>
<p>对于引用函数的地址无关，还引入了延迟绑定的技术，通过过程链接表，把函数地址的绑定推迟到第一次调用该函数的时候，第一次调用时，把函数地址填入GOT,第二次调用直接使用GOT里的地址。</p>
<p>该表存在于数据段，装载时，填入外部符号的地址。一般动态库的代码段只有一份，数据段由每个调用模块各自维护一份。   </p>
<p>令指令代码地址无关，可以使指令代码保持一份，节省内存；如果代码不是地址无关，则每个进程要维护一份副本，装载时重定位。使用-fPIC(linux)命令编译文件成地址无关共享模块。</p>
<p>#####动态链接器<br>加载可执行文件后，然后加载动态链接器，运行动态链接器，初始化动态链接的相关工作，最后才运行可执行文件。    </p>
<p>#####链接步骤<br>1启动动态链接器    </p>
<p>2装载共享对象           </p>
<p>3重定位和初始化(初始化执行.init段中的代码)             </p>
<p>###加载器加载可执行文件<br>操作系统创建进程，加载可执行文件，然后运行。具体做了以下三件事：</p>
<p>1创建独立虚拟地址空间(创建虚拟地址与内存的映射数据结构)    </p>
<p>2读取可执行文件程序头，创建虚拟地址与可执行文件的映射数据结构。(可执行或目标文件的段信息有指定对应的虚拟基地址。)     </p>
<p>3将CPU指令寄存器设置成可执行文件入口，启动运行。   </p>
<p>###reference<br>链接器和加载器</p>
<p>程序员的自我修养-链接、装载与库</p>
<p>深入理解计算机系统</p>
<p>###question<br>如何知道引用的符号是共享模块还是其他目标文件？   </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-11-c++_object_model/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-11-c++_object_model/" itemprop="url">C++对象模型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="C-对象模型"><a href="#C-对象模型" class="headerlink" title="C++对象模型"></a>C++对象模型</h2><h3 id="C-对象模型-1"><a href="#C-对象模型-1" class="headerlink" title="C++对象模型"></a>C++对象模型</h3><p>1非静态数据与指向存放虚函数地址的虚函数表的指针放在类的object内，其他静态数据、静态函数、非静态函数独立在object之外，包括虚函数表。<br>2继承基类的子类对象包含基类信息与自己的信息。<br>3虚继承的子类对象，     </p>
<h3 id="构造函数"><a href="#构造函数" class="headerlink" title="构造函数"></a>构造函数</h3><h4 id="缺省构造函数"><a href="#缺省构造函数" class="headerlink" title="缺省构造函数"></a>缺省构造函数</h4><h5 id="没用的-trivial-缺省构造函数"><a href="#没用的-trivial-缺省构造函数" class="headerlink" title="没用的(trivial)缺省构造函数"></a>没用的(trivial)缺省构造函数</h5><p>对于一个类，没用用户声明的构造函数，编译器不会合成缺省构造函数，只合成以下四种有用的构造函数。没有的函数当然不需要合成，很合理。      </p>
<h5 id="有用的缺省构造函数"><a href="#有用的缺省构造函数" class="headerlink" title="有用的缺省构造函数"></a>有用的缺省构造函数</h5><h6 id="一个类包含具有有构造函数的成员类"><a href="#一个类包含具有有构造函数的成员类" class="headerlink" title="一个类包含具有有构造函数的成员类"></a>一个类包含具有有构造函数的成员类</h6><pre><code>Class A
{
public:
    B b;
    int i;
}
Class B
{
public:
    B();
}</code></pre><p>编译器会在A的构造函数里显式的调用B的构造函数   </p>
<pre><code>Class A
{
public:
    inline A()
    {
        B::B();
    }
    B b;
    int i;
}</code></pre><p>如果程序员已经定义了A的构造函数，则编译器也会在构造函数开头插入调用B的构造函数的代码。   </p>
<pre><code>Class A
{
public:
    A()
    {
        **B::B();**
        i = 0;
    }
    B b;
}</code></pre><h6 id="继承带有缺省构造函数的基类"><a href="#继承带有缺省构造函数的基类" class="headerlink" title="继承带有缺省构造函数的基类"></a>继承带有缺省构造函数的基类</h6><p>编译器会合成构造函数来调用基类的构造函数，如果有多个基类，则根据声明顺序调用之。  </p>
<h6 id="带有虚函数的类"><a href="#带有虚函数的类" class="headerlink" title="带有虚函数的类"></a>带有虚函数的类</h6><p>编译器安插构造函数初始化虚函数表指针   </p>
<h6 id="虚继承的类"><a href="#虚继承的类" class="headerlink" title="虚继承的类"></a>虚继承的类</h6><p>同上类似，编译器需要初始化一些关于操作虚基类的代码。以后介绍。  </p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/01/06/2013-6-1-IO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2020/01/06/2013-6-1-IO/" itemprop="url">I/O</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-01-06T14:03:05+08:00">
                2020-01-06
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>阻塞式I/O(默认)，非阻塞式I/O(nonblock)，I/O复用(select/poll/epoll)都属于同步I/O，因为它们在数据由内核空间复制回进程缓冲区时都是阻塞的(不能干别的事)。只有异步I/O模型(AIO)是符合异步I/O操作的含义的，即在1数据准备完成、2由内核空间拷贝回缓冲区后 通知进程，在等待通知的这段时间里可以干别的事。</p>
<h2 id="windows-I-O"><a href="#windows-I-O" class="headerlink" title="windows I/O"></a>windows I/O</h2><h3 id="常见IO设备"><a href="#常见IO设备" class="headerlink" title="常见IO设备"></a>常见IO设备</h3><p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/io.PNG" alt=""></p>
<h3 id="同步IO"><a href="#同步IO" class="headerlink" title="同步IO"></a>同步IO</h3><p>线程请求IO操作，会阻塞被挂起。  </p>
<h3 id="异步IO"><a href="#异步IO" class="headerlink" title="异步IO"></a>异步IO</h3><p>线程请求IO操作，线程继续进行，不会阻塞。  </p>
<h4 id="将IO请求添加到设备驱动程序处理队列"><a href="#将IO请求添加到设备驱动程序处理队列" class="headerlink" title="将IO请求添加到设备驱动程序处理队列"></a>将IO请求添加到设备驱动程序处理队列</h4><p>在CreateFile创建设备对象的时候，传入FILE_FLAG_OVERLAPPED参数，告诉系统以异步方式访问设备。调用读写设备函数ReadFile、WriteFile，系统会将IO请求加入到设备驱动程序的队列中，并马上返回。设备驱动程序以最合理的顺序处理队列中的IO请求并非先进先处理。<br><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/readfile.PNG" alt=""><br>其中最重要的是OVERLAPPED结构，overlapped的意思是线程的执行与IO操作是同时发生的，执行时间是重叠的。<br><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/overlapped.PNG" alt=""><br>IO请求处理结束会返回该结构地址，可以创建一个包含OVERLAPPED结构的context结构，保存上下文，根据返回的OVERLAPPED结构地址，通过以下宏可以算出context结构的地址。   </p>
<pre><code>#define CONTAINING_RECORD(address, type, field) ((type *)( \ 
(PCHAR)(address) - \ 
(ULONG_PTR)(&amp;((type *)0)-&gt;field)))  field=context结构中的OVERLAPPED结构</code></pre><h4 id="接收IO请求完成的通知"><a href="#接收IO请求完成的通知" class="headerlink" title="接收IO请求完成的通知"></a>接收IO请求完成的通知</h4><p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/iocomplete.PNG" alt="">   </p>
<h5 id="1-触发设备内核对象："><a href="#1-触发设备内核对象：" class="headerlink" title="1.触发设备内核对象："></a>1.触发设备内核对象：</h5><p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/ioc1.PNG" alt=""><br>缺点：同时发出多个IO请求，例如先read,然后write,最后waitforobject，不知道最后触发的设备内核对象是针对哪个IO请求。  </p>
<h5 id="2-触发事件内核对象："><a href="#2-触发事件内核对象：" class="headerlink" title="2.触发事件内核对象："></a>2.触发事件内核对象：</h5><p>对不同请求创建事件并赋值给OVERLAPPED结构里的hEvent成员变量。<br><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/ioc2_1.PNG" alt=""><br><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/ioc2_2.PNG" alt="">  </p>
<h5 id="3-可提醒IO："><a href="#3-可提醒IO：" class="headerlink" title="3.可提醒IO："></a>3.可提醒IO：</h5><p>当系统创建线程的时候，会创建与它相关联的异步过程调用队列(asynchronous procedure call,APC)。当发出一个IO请求的时候，可以告诉设备驱动系统，<strong>当设备驱动程序完成IO操作，就在APC队列中添加回调函数</strong>。<br><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/ioc3.PNG" alt=""><br>最后线程可用6个函数将自己睡去并设置为可唤醒状态。如果APC队列里有回调函数，系统会唤醒线程并在同线程内执行回调函数，清空队列后，该6个函数就返回。<br><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/ioc3_1.PNG" alt=""><br>缺点：1.回调函数提供的上下文少。2.一个线程发出的多个IO请求只能在同一个线程内执行，负载不够均衡。<br>windows还提供QueueUserAPC函数，允许程序员向线程APC队列里添加回调函数。  </p>
<h5 id="4-IO完成端口"><a href="#4-IO完成端口" class="headerlink" title="4.IO完成端口"></a>4.IO完成端口</h5><p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/ioc4.PNG" alt="">   </p>
<p>创建一个IO完成端口，可以将多个设备及各自的完成键(表明IO请求类型(读文件、写文件或者发送套接字等等))与一个完成端口联系起来，并指定几个线程来处理完成端口中完成队列里的IO请求完成的消息。  </p>
<p>线程调用GetQueuedCompletionStatus函数令自己进入睡眠状态，并把自己的线程ID放入等待线程队列，让完成端口内核对象知道有哪些线程在等待IO请求完成，线程等待设备驱动程序处理IO请求并把IO请求的完成键等记录放入IO完成队列后，线程被唤醒，根据IO完成队列里的记录处理IO请求完成后的业务。  </p>
<p>IO完成队列里的记录包括已传输的字节数、完成键、错误代码、OVERLAPPED结构地址，通过返回GetQueuedCompletionStatus函数的参数告知线程。<br><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/ioc4_1.PNG" alt="">   </p>
<p>设备列表与等待线程列表<br><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/iocp5.PNG" alt=""> </p>
<h2 id="linux-I-O"><a href="#linux-I-O" class="headerlink" title="linux I/O"></a>linux I/O</h2><h3 id="1-阻塞IO"><a href="#1-阻塞IO" class="headerlink" title="1.阻塞IO"></a>1.阻塞IO</h3><p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/io1.png" alt=""> </p>
<h3 id="2-非阻塞IO"><a href="#2-非阻塞IO" class="headerlink" title="2.非阻塞IO"></a>2.非阻塞IO</h3><p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/io2.png" alt=""> </p>
<h3 id="3-IO多路复用"><a href="#3-IO多路复用" class="headerlink" title="3.IO多路复用:"></a>3.IO多路复用:</h3><p>一个进程处理多个IO请求</p>
<p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/io3.png" alt=""> </p>
<p>3.1. select/pselect</p>
<p>监视一系列sockets（文件描述符）并阻塞程序，直到至少有一个准备好时行I/O操作。</p>
<p>需要把fd集合从用户态拷贝到内核态返回时还要从内核态拷贝到用户态</p>
<p>内核会先轮询IO是否完成，如果没有再睡眠进程</p>
<p>select支持的文件描述符数量太小了，默认是1024</p>
<p>3.2. poll</p>
<p>和select类似，不同的是传入fd数组，没有个数限制</p>
<p>3.3. epoll</p>
<p>与select不同，不会轮询IO是否完成，而是IO完成后，通过回调函数将发生的事件写入就绪事件链表，写入用户空间。</p>
<p><a href="http://www.cnblogs.com/haippy/archive/2012/01/09/2317269.html" target="_blank" rel="noopener">example1</a></p>
<p><a href="http://www.cnblogs.com/Anker/p/3263780.html" target="_blank" rel="noopener">example2</a></p>
<p>epoll_create创建epoll句柄</p>
<h3 id="4-信号驱动的IO"><a href="#4-信号驱动的IO" class="headerlink" title="4.信号驱动的IO"></a>4.信号驱动的IO</h3><p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/io4.PNG" alt=""> </p>
<h3 id="5-异步IO"><a href="#5-异步IO" class="headerlink" title="5.异步IO"></a>5.异步IO</h3><p><img src="https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/io5.PNG" alt=""> </p>
<p>5.1.信号回调函数机制</p>
<p>5.2.线程回调函数机制</p>
<h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p><a href="http://blog.csdn.net/mikeszhang/article/details/8891089" target="_blank" rel="noopener">http://blog.csdn.net/mikeszhang/article/details/8891089</a></p>
<h2 id="知乎关于阻塞非阻塞同步非同步的讨论"><a href="#知乎关于阻塞非阻塞同步非同步的讨论" class="headerlink" title="知乎关于阻塞非阻塞同步非同步的讨论"></a>知乎关于阻塞非阻塞同步非同步的讨论</h2><p><a href="http://www.zhihu.com/question/19732473" target="_blank" rel="noopener">http://www.zhihu.com/question/19732473</a></p>
<p>因为中文语意的问题，很多时候确实会导致混用，而且语境不一样意义也可能不一样。如果只是从计算机编程这个角度说， 讨论最多的也是IO 模型 ，阻塞非阻塞 和 同步异步说的应该是不同的东西。</p>
<p>阻塞非阻塞：可以简单理解为需要做一件事能不能立即得到返回应答，如果不能立即获得返回，需要等待，那就阻塞了，否则就可以理解为非阻塞。<br>同步异步： 你总是做完一件再去做另一件，不管是否需要时间等待，这就是同步；异步呢则反之，你可以同时做几件事，并非一定需要一件事做完再做另一件事。同步简单理解成一问一答同步进行，异步可以简单理解为不必等一个问题有答了再去问另一个问题，尽管问，有答了再通知你。</p>
<p>2015/2/4 还有人问，这里补充下，其他楼层也有很好的解释，包括从技术角度都有的详细解释。主要搞清楚本质就行了，他们的不同在于：</p>
<ol>
<li>阻塞非阻塞表示下面 买书过程中 可能出现的状态，是从 我 这个单角色角度来看待这个买书这个问题。</li>
<li>同步异步表示一种协作方式，是从全局更高的角度 “进程之间 合作的方式” 来看待买书这个业务。两个进程之间如果商量采用异步方式处理买书这一业务，就不存在阻塞这种状态。</li>
</ol>
<p>举个例子：<br>我去买一本书，立即买到了，这就是非阻塞；<br>如果恰好书店没有，我就等一直等到书店有了这本书买到了才走，这就是阻塞；<br>如果书店恰好没有，我就告诉书店老板，书来了告诉我一声让我来取或者直接送到我家，然后我就走了，这就是异步。<br>那同步呢？ 前面两种情况，非阻塞和阻塞都可以称为同步。<br>如果说书店有这书，我还让老板通知我以后来取就没这个必要了。</p>
<p>反映在编程方面就是 用户进程 调用 系统调用。(用户进程对应我，内核 对应 书店老板，书对应数据资源data ， 买书就是一个系统调用了)<br>这阻塞非阻塞与同步异步IO机制，都是伴随计算机系统发展，用来解决一些出现的问题。阻塞非阻塞、同步异步可以组合，但是没必要组合，应该说是不同的IO机制，没必要纠结怎么区分，如果定要组合心里才爽，可以 这样认为：阻塞非阻塞都是同步，异步就没什么阻塞不阻塞了，都异步了还阻塞啥，肯定是非阻塞了。(异步非阻塞听起来多别扭)</p>
<p>unix网络编程中说到：<br>将IO模型分为五类：阻塞IO，非阻塞IO，IO复用，信号驱动，异步IO<br>其中阻塞IO就是那种recv, read，一直等，等到有了拷贝了数据才返回；<br>非阻塞就是不用等，立即返回，设置描述符为非阻塞就行了，但是要进程自己一直检查是否可读；<br>IO复用其实也是阻塞的，不过可以用来等很多描述符；<br>信号驱动采用信号机制等待；<br>异步IO就不用等待了，当他告知你的时候，已经可以返回了，数据都拷贝好了。</p>
<p>posix.1严格定义的异步IO是要求没有任何一点阻塞，而上述的前面四个（阻塞IO，非阻塞IO，IO复用，信号驱动）都不同程度阻塞了，而且都有一个共同的阻塞： 内核拷贝数据到进程空间的这段时间需要等待。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/23/">&lt;i class&#x3D;&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/23/">23</a><span class="page-number current">24</span><a class="page-number" href="/page/25/">25</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" href="/page/25/">&lt;i class&#x3D;&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">273</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
