---

layout: default

title:  tomcat

---

## tomcat原理

### 解析webapps所有war包
解压war包，导入class

读取WEB-INF文件夹里xml配置（或注解（springboot））

类加载servert class

### socket网络编程
一个线程监听连接，另外一个线程处理请求

### connector组件
连接器，监听接口

接受连接请求，分配线程让container来处理这个请求。

![](https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/connector.jpeg)
#### endpoint
默认NioEndpoint，监听端口

生产者，消费者模式

Socket acceptor thread

Socket poller thread

Woker threads pool
#### 

### service组件

### container组件
通用容器，包括以下容器
#### engine
servlet引擎（责任链模式）
#### host
主机
#### context
webapp
#### wrapper
Servlet

### executor
线程池

#### processor

#### protocol

### 启动
#### lifecycle生命周期
#### 初始化
#### 启动
catalina -> server -> (service1 service2 ...)

service -> (engine connector1 connector2 ...)

engine -> host -> context -> wrapper

### 三个类加载器
Common ClassLoader

Catalina ClassLoader

Shared ClassLoader

![](https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/tomcat-engine.jpeg)

![](https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/tomcat-context.jpeg)

![](https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/tomcat.png)

![](https://github.com/garydai/garydai.github.com/raw/master/_posts/pic/tomcat2.png)